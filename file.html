<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Greens Cafe - Order Management System</title>
    <!-- Use Tailwind CSS for rapid styling and a modern look -->
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* Custom Styles to enhance the dark theme */
        :root {
            --color-primary: #d4a574;
            /* Coffee/Amber color for accents */
            --color-primary-dark: #b88b59;
            --color-bg-dark: #1a1a1a;
            --color-bg-light: #2d2d2d;
            --color-text: #f5f5f5;
        }

        body {
            background-color: var(--color-bg-dark);
            color: var(--color-text);
            font-family: ui-sans-serif, system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, "Noto Sans", sans-serif;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(20px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .animate-fadeIn {
            animation: fadeIn 0.6s ease-out;
        }

        * {
            box-sizing: border-box;
        }

        /* Chalkboard-like background effect for dashboards */
        .chalkboard-bg {
            background-color: var(--color-bg-light);
            background-image:
                repeating-linear-gradient(0deg, transparent, transparent 2px, rgba(255, 255, 255, .03) 2px, rgba(255, 255, 255, .03) 4px),
                repeating-linear-gradient(90deg, transparent, transparent 2px, rgba(255, 255, 255, .03) 2px, rgba(255, 255, 255, .03) 4px);
        }

        /* Override Tailwind for primary button styling to match theme */
        .btn-primary {
            background-color: var(--color-primary);
            color: var(--color-bg-dark);
            transition: background-color 300ms;
        }

        .btn-primary:hover {
            background-color: var(--color-primary-dark);
        }
    </style>
</head>

<body class="m-0 p-0">
    <!-- Main application container -->
    <div id="app"></div>

    <script>
        // Menu Data
        const menuData = {
            'Main Courses': [
                { id: 1, name: 'Grilled Chicken', description: 'Juicy grilled chicken with herbs', price: 12.99 },
                { id: 2, name: 'Beef Burger', description: 'Classic burger with cheese and fries', price: 10.99 },
                { id: 3, name: 'Pasta Carbonara', description: 'Creamy pasta with bacon', price: 11.99 },
                { id: 4, name: 'Caesar Salad', description: 'Fresh romaine with parmesan', price: 8.99 },
            ],
            'Beverages': [
                { id: 5, name: 'Coca Cola', description: 'Chilled soft drink', price: 2.99 },
                { id: 6, name: 'Fresh Orange Juice', description: 'Freshly squeezed', price: 4.99 },
                { id: 7, name: 'Cappuccino', description: 'Italian coffee specialty', price: 5.99 },
                { id: 8, name: 'Iced Tea', description: 'Refreshing lemon tea', price: 3.99 },
            ],
        };

        // Mock Users
        const mockUsers = {
            waiters: [
                { uid: '1001234567', password: 'waiter123', name: 'John Doe', email: 'john@cafe.com' },
                { uid: '1001234568', password: 'waiter123', name: 'Jane Smith', email: 'jane@cafe.com' },
            ],
            owners: [
                { uid: '2000000001', password: 'owner123', name: 'Michael Anderson', email: 'michael@cafe.com' },
            ],
        };

        // State
        let state = {
            view: 'landing',
            currentRole: null,
            currentUser: null,
            cart: [],
            orders: [
                { id: 1001, tableNo: 5, items: 'Grilled Chicken, Coca Cola', total: 15.98, status: 'pending', waiter: 'John Doe', date: '2024-11-30' },
                { id: 1002, tableNo: 3, items: 'Beef Burger, Orange Juice', total: 15.98, status: 'preparing', waiter: 'Jane Smith', date: '2024-11-30' },
                { id: 1000, tableNo: 2, items: 'Pasta Carbonara, Caesar Salad', total: 20.98, status: 'completed', waiter: 'John Doe', date: '2024-11-30' },
            ]
        };

        // Helper Functions (Identical to the first code block)
        function setState(newState) {
            state = { ...state, ...newState };
            render();
        }

        function addToCart(item) {
            const existing = state.cart.find(i => i.id === item.id);
            if (existing) {
                setState({ cart: state.cart.map(i => i.id === item.id ? { ...i, quantity: i.quantity + 1 } : i) });
            } else {
                setState({ cart: [...state.cart, { ...item, quantity: 1 }] });
            }
        }

        function removeFromCart(itemId) {
            setState({ cart: state.cart.filter(i => i.id !== itemId) });
        }

        function updateQuantity(itemId, change) {
            setState({
                cart: state.cart.map(i => {
                    if (i.id === itemId) {
                        const newQty = i.quantity + change;
                        return newQty > 0 ? { ...i, quantity: newQty } : i;
                    }
                    return i;
                }).filter(i => i.quantity > 0)
            });
        }

        function calculateTotal() {
            return state.cart.reduce((sum, item) => sum + (item.price * item.quantity), 0).toFixed(2);
        }

        function handleLogin(uid, password, role) {
            const users = role === 'waiter' ? mockUsers.waiters : mockUsers.owners;
            const user = users.find(u => u.uid === uid && u.password === password);

            if (user) {
                setState({ currentUser: user, currentRole: role, view: role });
            } else {
                alert('Invalid credentials');
            }
        }

        // Render Functions
        function render() {
            const app = document.getElementById('app');

            if (state.view === 'landing') {
                app.innerHTML = renderLanding();
            } else if (state.view === 'roleSelect') {
                app.innerHTML = renderRoleSelect();
            } else if (state.view === 'login') {
                app.innerHTML = renderLogin();
            } else if (state.view === 'customer') {
                app.innerHTML = renderCustomer();
            } else if (state.view === 'waiter') {
                app.innerHTML = renderWaiter();
            } else if (state.view === 'owner') {
                app.innerHTML = renderOwner();
            }

            attachEventListeners();
        }

        // --- ENHANCED RENDER FUNCTIONS ---

        function renderLanding() {
            return `
                <div class="min-h-screen chalkboard-bg flex flex-col items-center justify-center p-8">
                    <div class="max-w-4xl mx-auto text-center animate-fadeIn">
                        <div class="w-24 h-24 sm:w-36 sm:h-36 bg-amber-700/50 border-4 border-amber-500 rounded-full flex items-center justify-center text-6xl sm:text-8xl mb-8 mx-auto shadow-2xl">‚òï</div>
                        <h1 class="text-6xl sm:text-7xl font-bold text-amber-400 mb-4 font-serif italic" style="text-shadow: 0 0 10px rgba(212, 165, 116, 0.5);">Greens Cafe</h1>
                        <p class="text-xl sm:text-2xl text-gray-400 italic mb-10">"Where Every Sip Tells a Story"</p>
                        
                        <div class="bg-gray-800/70 border-2 border-amber-600/50 rounded-xl p-8 shadow-xl mb-12">
                            <h3 class="text-3xl font-bold text-amber-400 mb-6 border-b border-gray-600 pb-3">About Our Establishment</h3>
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-x-12 gap-y-6 text-left text-gray-300 text-lg">
                                <div><strong class="text-amber-500">Owner:</strong> Michael Anderson</div>
                                <div><strong class="text-amber-500">Co-Owner:</strong> Sarah Anderson</div>
                                <div><strong class="text-amber-500">Contact:</strong> +1 (555) 123-4567</div>
                                <div><strong class="text-amber-500">Location:</strong> 123 Coffee Street</div>
                                <div><strong class="text-amber-500">Hours:</strong> 7:00 AM - 10:00 PM</div>
                                <div><strong class="text-amber-500">Code:</strong> MC-2456</div>
                            </div>
                        </div>

                        <button onclick="setState({view: 'roleSelect'})" class="btn-primary px-12 py-4 rounded-full text-xl font-semibold shadow-2xl tracking-wider">
                            Enter Cafe ‚Üí
                        </button>
                    </div>
                </div>
            `;
        }

        function renderRoleSelect() {
            return `
                <div class="min-h-screen chalkboard-bg flex items-center justify-center p-8">
                    <div class="max-w-5xl w-full">
                        <button onclick="setState({view: 'landing'})" class="text-amber-400 mb-10 hover:text-amber-300 transition-colors">
                            ‚Üê Back to Home
                        </button>
                        
                        <h2 class="text-5xl font-bold text-center text-amber-400 mb-12" style="text-shadow: 0 0 8px rgba(212, 165, 116, 0.4);">Select Your Role</h2>
                        
                        <div class="grid grid-cols-1 md:grid-cols-3 gap-8">
                            <div class="bg-gray-800/70 border-2 border-amber-600/50 rounded-2xl p-8 text-center hover:bg-gray-700/70 transition-all cursor-pointer shadow-lg" onclick="setState({view: 'customer'})">
                                <div class="text-7xl mb-4 text-amber-400">üë§</div>
                                <h3 class="text-2xl font-bold text-white mb-2">Customer</h3>
                                <p class="text-gray-400 mb-6">Browse menu and order</p>
                                <button class="btn-primary px-6 py-2 rounded-lg">
                                    Continue
                                </button>
                            </div>
                            <div class="bg-gray-800/70 border-2 border-amber-600/50 rounded-2xl p-8 text-center hover:bg-gray-700/70 transition-all cursor-pointer shadow-lg" onclick="setState({currentRole: 'waiter', view: 'login'})">
                                <div class="text-7xl mb-4 text-amber-400">üçΩÔ∏è</div>
                                <h3 class="text-2xl font-bold text-white mb-2">Waiter</h3>
                                <p class="text-gray-400 mb-6">Manage orders</p>
                                <button class="btn-primary px-6 py-2 rounded-lg">
                                    Continue
                                </button>
                            </div>
                            <div class="bg-gray-800/70 border-2 border-amber-600/50 rounded-2xl p-8 text-center hover:bg-gray-700/70 transition-all cursor-pointer shadow-lg" onclick="setState({currentRole: 'owner', view: 'login'})">
                                <div class="text-7xl mb-4 text-amber-400">üëî</div>
                                <h3 class="text-2xl font-bold text-white mb-2">Owner</h3>
                                <p class="text-gray-400 mb-6">View analytics</p>
                                <button class="btn-primary px-6 py-2 rounded-lg">
                                    Continue
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            `;
        }

        function renderLogin() {
            return `
                <div class="min-h-screen chalkboard-bg flex items-center justify-center p-8">
                    <div class="bg-gray-800/90 border-2 border-amber-600/50 rounded-xl p-10 max-w-md w-full shadow-2xl">
                        <button onclick="setState({view: 'roleSelect'})" class="text-amber-400 mb-8 hover:text-amber-300">
                            ‚Üê Back
                        </button>
                        
                        <h2 class="text-3xl font-bold text-amber-400 mb-8 text-center">
                            ${state.currentRole === 'waiter' ? 'Waiter' : 'Owner'} Login
                        </h2>
                        
                        <div class="space-y-6">
                            <div>
                                <label class="block text-gray-300 mb-2 font-semibold">User ID (UID)</label>
                                <input id="loginUid" type="text" placeholder="e.g., 1001234567" 
                                    value="${state.currentRole === 'waiter' ? '1001234567' : '2000000001'}"
                                    class="w-full bg-gray-700 text-white px-4 py-3 rounded-lg focus:outline-none focus:ring-2 focus:ring-amber-400 border border-gray-600">
                            </div>
                            
                            <div>
                                <label class="block text-gray-300 mb-2 font-semibold">Password</label>
                                <input id="loginPassword" type="password" 
                                    value="${state.currentRole === 'waiter' ? 'waiter123' : 'owner123'}"
                                    class="w-full bg-gray-700 text-white px-4 py-3 rounded-lg focus:outline-none focus:ring-2 focus:ring-amber-400 border border-gray-600">
                            </div>
                            
                            <button onclick="doLogin()" class="btn-primary w-full py-3 rounded-lg font-semibold shadow-md">
                                Login
                            </button>
                            
                            <p class="text-center text-gray-500 text-sm">
                                Demo credentials are pre-filled for testing
                            </p>
                        </div>
                    </div>
                </div>
            `;
        }

        function renderCustomer() {
            const total = calculateTotal();
            return `
                <div class="min-h-screen chalkboard-bg p-8">
                    <div class="max-w-7xl mx-auto">
                        <div class="flex justify-between items-center mb-10">
                            <h1 class="text-4xl font-bold text-amber-400">Greens Cafe Menu</h1>
                            <button onclick="setState({view: 'roleSelect', cart: []})" class="bg-red-700 text-white px-6 py-2 rounded-lg hover:bg-red-600 transition-colors shadow-md">
                                Exit
                            </button>
                        </div>

                        <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
                            <div class="lg:col-span-2 space-y-10">
                                ${Object.entries(menuData).map(([category, items]) => `
                                    <div class="animate-fadeIn">
                                        <h2 class="text-3xl font-bold text-amber-400 mb-6 border-b-2 border-amber-600 pb-2">${category}</h2>
                                        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                                            ${items.map(item => `
                                                <div class="bg-gray-800/70 border border-amber-600/40 rounded-xl p-6 hover:bg-gray-700/70 transition-all shadow-lg">
                                                    <h3 class="text-xl font-bold text-white mb-2">${item.name}</h3>
                                                    <p class="text-gray-400 text-sm h-12">${item.description}</p>
                                                    <div class="flex justify-between items-center mt-4">
                                                        <span class="text-2xl font-bold text-amber-400">$${item.price}</span>
                                                        <button onclick="addToCart(${JSON.stringify(item).replace(/"/g, '&quot;')})" class="btn-primary px-4 py-2 rounded-full text-sm font-semibold">
                                                            + Add to Order
                                                        </button>
                                                    </div>
                                                </div>
                                            `).join('')}
                                        </div>
                                    </div>
                                `).join('')}
                            </div>

                            <div class="bg-gray-800 border-2 border-amber-600/50 rounded-xl p-6 h-fit sticky top-4 shadow-2xl">
                                <h2 class="text-2xl font-bold text-amber-400 mb-6 border-b border-gray-700 pb-3">üõí Your Order</h2>
                                
                                ${state.cart.length === 0 ? `
                                    <p class="text-gray-500 text-center py-12 italic">Your cart is empty. Start adding delicious items!</p>
                                ` : `
                                    <div class="space-y-4 mb-6">
                                        ${state.cart.map(item => `
                                            <div class="bg-gray-700/50 rounded-lg p-4">
                                                <div class="flex justify-between items-center mb-2">
                                                    <span class="text-white font-semibold">${item.name}</span>
                                                    <button onclick="removeFromCart(${item.id})" class="text-red-400 hover:text-red-300 transition-colors text-lg" title="Remove Item">‚úï</button>
                                                </div>
                                                <div class="flex justify-between items-center">
                                                    <div class="flex items-center gap-2">
                                                        <button onclick="updateQuantity(${item.id}, -1)" class="bg-gray-600 text-white px-3 py-1 rounded hover:bg-gray-500">-</button>
                                                        <span class="text-white w-4 text-center font-bold">${item.quantity}</span>
                                                        <button onclick="updateQuantity(${item.id}, 1)" class="bg-gray-600 text-white px-3 py-1 rounded hover:bg-gray-500">+</button>
                                                    </div>
                                                    <span class="text-amber-400 font-bold text-lg">$${(item.price * item.quantity).toFixed(2)}</span>
                                                </div>
                                            </div>
                                        `).join('')}
                                    </div>

                                    <div class="border-t border-gray-600 pt-4 mb-6">
                                        <div class="flex justify-between text-2xl font-extrabold">
                                            <span class="text-white">TOTAL:</span>
                                            <span class="text-amber-400">$${total}</span>
                                        </div>
                                    </div>

                                    <button onclick="placeOrder()" class="btn-primary w-full py-3 rounded-lg font-semibold shadow-xl">
                                        Confirm & Place Order
                                    </button>
                                `}
                            </div>
                        </div>
                    </div>
                </div>
            `;
        }


        function renderWaiter() {
            const waiterOrders = state.orders.filter(o => o.waiter === state.currentUser?.name);
            return `
                <div class="min-h-screen chalkboard-bg p-8">
                    <div class="max-w-7xl mx-auto">
                        <div class="flex justify-between items-center mb-10 pb-4 border-b border-gray-700">
                            <h1 class="text-4xl font-bold text-amber-400">Waiter Dashboard</h1>
                            <div class="flex gap-4 items-center">
                                <span class="text-amber-400 bg-gray-700/50 px-4 py-2 rounded-full font-semibold">Welcome, ${state.currentUser?.name}</span>
                                <button onclick="setState({view: 'roleSelect', currentUser: null})" class="bg-red-700 text-white px-6 py-2 rounded-lg hover:bg-red-600 transition-colors">
                                    Logout
                                </button>
                            </div>
                        </div>

                        <div class="bg-gray-800/70 border border-amber-600/50 rounded-xl p-6 mb-8 shadow-xl">
                            <h2 class="text-2xl font-bold text-amber-400 mb-6">My Assigned Orders (${waiterOrders.length})</h2>
                            <div class="overflow-x-auto">
                                <table class="w-full text-left">
                                    <thead>
                                        <tr class="text-amber-400 border-b border-amber-600/50">
                                            <th class="p-4 text-lg">Table</th>
                                            <th class="p-4 text-lg">Order ID</th>
                                            <th class="p-4 text-lg">Items</th>
                                            <th class="p-4 text-lg">Total</th>
                                            <th class="p-4 text-lg">Status</th>
                                        </tr>
                                    </thead>
                                    <tbody class="divide-y divide-gray-700">
                                        ${waiterOrders.map(order => `
                                            <tr class="text-gray-300 hover:bg-gray-700/50 transition-colors">
                                                <td class="p-4 font-bold text-white">${order.tableNo}</td>
                                                <td class="p-4">#${order.id}</td>
                                                <td class="p-4 text-sm">${order.items}</td>
                                                <td class="p-4 text-amber-300">$${order.total}</td>
                                                <td class="p-4">
                                                    <span class="px-3 py-1 rounded-full text-xs font-semibold ${order.status === 'pending' ? 'bg-yellow-600 text-yellow-100' :
                    order.status === 'preparing' ? 'bg-blue-600 text-blue-100' : 'bg-green-600 text-green-100'
                }">${order.status.toUpperCase()}</span>
                                                </td>
                                            </tr>
                                        `).join('')}
                                    </tbody>
                                </table>
                            </div>
                        </div>

                        <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                            <div class="bg-gray-800/70 border border-amber-600/50 rounded-xl p-6 text-center shadow-lg">
                                <div class="text-5xl mb-3 text-amber-400">üí∞</div>
                                <h3 class="text-lg text-gray-400 mb-1">Total Earnings</h3>
                                <p class="text-3xl font-bold text-white">$203.50</p>
                            </div>
                            <div class="bg-gray-800/70 border border-amber-600/50 rounded-xl p-6 text-center shadow-lg">
                                <div class="text-5xl mb-3 text-amber-400">üìà</div>
                                <h3 class="text-lg text-gray-400 mb-1">Commission</h3>
                                <p class="text-3xl font-bold text-white">$125.50</p>
                            </div>
                            <div class="bg-gray-800/70 border border-amber-600/50 rounded-xl p-6 text-center shadow-lg">
                                <div class="text-5xl mb-3 text-amber-400">‚≠ê</div>
                                <h3 class="text-lg text-gray-400 mb-1">Tips Received</h3>
                                <p class="text-3xl font-bold text-white">$78.00</p>
                            </div>
                        </div>
                    </div>
                </div>
            `;
        }

        function renderOwner() {
            return `
                <div class="min-h-screen chalkboard-bg p-8">
                    <div class="max-w-7xl mx-auto">
                        <div class="flex justify-between items-center mb-10 pb-4 border-b border-gray-700">
                            <h1 class="text-4xl font-bold text-amber-400">Owner Dashboard</h1>
                            <button onclick="setState({view: 'roleSelect', currentUser: null})" class="bg-red-700 text-white px-6 py-2 rounded-lg hover:bg-red-600 transition-colors">
                                Logout
                            </button>
                        </div>

                        <div class="grid grid-cols-2 md:grid-cols-4 gap-6 mb-8">
                            <div class="bg-gray-800/70 border border-amber-700/50 rounded-xl p-6 text-center shadow-lg">
                                <h3 class="text-gray-400 mb-2">Total Sales</h3>
                                <p class="text-3xl font-bold text-amber-300">$1,245.50</p>
                            </div>
                            <div class="bg-gray-800/70 border border-amber-700/50 rounded-xl p-6 text-center shadow-lg">
                                <h3 class="text-gray-400 mb-2">Total Orders</h3>
                                <p class="text-3xl font-bold text-amber-300">48</p>
                            </div>
                            <div class="bg-gray-800/70 border border-amber-700/50 rounded-xl p-6 text-center shadow-lg">
                                <h3 class="text-gray-400 mb-2">Net Profit</h3>
                                <p class="text-3xl font-bold text-green-400">$622.25</p>
                            </div>
                            <div class="bg-gray-800/70 border border-amber-700/50 rounded-xl p-6 text-center shadow-lg">
                                <h3 class="text-gray-400 mb-2">Avg Order</h3>
                                <p class="text-3xl font-bold text-amber-300">$25.95</p>
                            </div>
                        </div>

                        <div class="bg-gray-800/70 border border-amber-600/50 rounded-xl p-6 mb-8 shadow-xl">
                            <h2 class="text-2xl font-bold text-amber-400 mb-6">All Orders History</h2>
                            <div class="overflow-x-auto">
                                <table class="w-full text-left">
                                    <thead>
                                        <tr class="text-amber-400 border-b border-amber-600/50">
                                            <th class="p-4">Date</th>
                                            <th class="p-4">Order ID</th>
                                            <th class="p-4">Table</th>
                                            <th class="p-4">Items</th>
                                            <th class="p-4">Total</th>
                                            <th class="p-4">Status</th>
                                            <th class="p-4">Waiter</th>
                                        </tr>
                                    </thead>
                                    <tbody class="divide-y divide-gray-700">
                                        ${state.orders.map(order => `
                                            <tr class="text-gray-300 hover:bg-gray-700/50 transition-colors">
                                                <td class="p-4 text-sm">${order.date}</td>
                                                <td class="p-4">#${order.id}</td>
                                                <td class="p-4 font-bold text-white">${order.tableNo}</td>
                                                <td class="p-4 text-sm">${order.items}</td>
                                                <td class="p-4 text-amber-300">$${order.total}</td>
                                                <td class="p-4">
                                                    <span class="px-3 py-1 rounded-full text-xs font-semibold ${order.status === 'pending' ? 'bg-yellow-600 text-yellow-100' :
                    order.status === 'preparing' ? 'bg-blue-600 text-blue-100' : 'bg-green-600 text-green-100'
                }">${order.status.toUpperCase()}</span>
                                                </td>
                                                <td class="p-4">${order.waiter}</td>
                                            </tr>
                                        `).join('')}
                                    </tbody>
                                </table>
                            </div>
                        </div>

                        <div class="bg-gray-800/70 border border-amber-600/50 rounded-xl p-6 shadow-xl">
                            <h2 class="text-2xl font-bold text-amber-400 mb-6">Waiter Performance</h2>
                            <div class="overflow-x-auto">
                                <table class="w-full text-left">
                                    <thead>
                                        <tr class="text-amber-400 border-b border-amber-600/50">
                                            <th class="p-4">Name</th>
                                            <th class="p-4">UID</th>
                                            <th class="p-4">Orders</th>
                                            <th class="p-4">Commission</th>
                                            <th class="p-4">Tips</th>
                                            <th class="p-4">Rating</th>
                                        </tr>
                                    </thead>
                                    <tbody class="divide-y divide-gray-700">
                                        ${mockUsers.waiters.map(waiter => `
                                            <tr class="text-gray-300 hover:bg-gray-700/50 transition-colors">
                                                <td class="p-4">${waiter.name}</td>
                                                <td class="p-4">${waiter.uid}</td>
                                                <td class="p-4">24</td>
                                                <td class="p-4">$62.50</td>
                                                <td class="p-4">$45.00</td>
                                                <td class="p-4 text-yellow-400">‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê</td>
                                            </tr>
                                        `).join('')}
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>
            `;
        }

        // --- END ENHANCED RENDER FUNCTIONS ---


        function attachEventListeners() {
            // Global functions needed for onclick handlers
            window.setState = setState;
            window.addToCart = addToCart;
            window.removeFromCart = removeFromCart;
            window.updateQuantity = updateQuantity;
            window.doLogin = function () {
                const uid = document.getElementById('loginUid').value;
                const password = document.getElementById('loginPassword').value;
                handleLogin(uid, password, state.currentRole);
            };
            window.placeOrder = function () {
                alert('Order placed successfully! Total: $' + calculateTotal());
                // In a real app, this would send data to a server
                setState({ cart: [] });
            };
        }

        // Initial render
        render();
    </script>
</body>

</html>